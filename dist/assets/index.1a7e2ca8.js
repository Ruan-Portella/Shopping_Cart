(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();const P=async e=>{if(!e)throw new Error("Forne\xE7a um CEP");const r=await fetch(`https://cep.awesomeapi.com.br/json/${e}`).then(n=>n.json()),c=await(await fetch(`https://brasilapi.com.br/api/cep/v2/${e}`)).json();return await Promise.any([r,c])},S=async()=>{const e=document.querySelector(".cart__address");try{const r=document.querySelector(".cep-input").value,{address:o,street:c,district:t,neighborhood:n,state:s,city:d}=await P(r);if(!o)throw new Error("CEP n\xE3o encontrado");e.innerHTML=`${o||c} - ${t||n} - ${d} - ${s}`}catch(r){return e.innerHTML="CEP n\xE3o encontrado",r}},C=async e=>{const r=`https://api.mercadolibre.com/items/${e}`;if(!e)throw new Error("ID n\xE3o informado");return await(await fetch(r)).json()},L=async e=>{const r=`https://api.mercadolibre.com/sites/MLB/search?q=${e}`;if(!e)throw new Error("Termo de busca n\xE3o informado");return(await(await fetch(r)).json()).results},h=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},I=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const o=[...h(),e];localStorage.setItem("cartProducts",JSON.stringify(o))},b=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const r=[...h()],o=r.indexOf(e);r.splice(o,1),localStorage.setItem("cartProducts",JSON.stringify(r))},m=e=>{const r=document.createElement("img");return r.className="product__image",r.src=e.replace("I.jpg","O.jpg"),r},a=(e,r,o="")=>{const c=document.createElement(e);return c.className=r,c.innerText=o,c},_=()=>{let e=0;const r=document.querySelector(".total-price");document.querySelector(".cart__products").querySelectorAll(".product__price__value").forEach(t=>{e+=Number(t.innerText)}),r.innerText=e.toFixed(2)},q=e=>e.querySelector("span.product__id").innerText,A=(e,r)=>{e.remove(),b(r),_()},g=({id:e,title:r,price:o,pictures:c})=>{const t=document.createElement("li");t.className="cart__product";const n=a("div","cart__product__image-container"),s=m(c[0].url);n.appendChild(s);const d=m((c[1]||c[0]).url);n.appendChild(d),t.appendChild(n);const i=a("div","cart__product__info-container");i.appendChild(a("span","product__title",r));const l=a("span","product__price","R$ ");l.appendChild(a("span","product__price__value",o)),i.appendChild(l),t.appendChild(i);const p=a("i","material-icons cart__product__remove","delete");return t.appendChild(p),t.addEventListener("click",()=>A(t,e)),t},N=({id:e,title:r,thumbnail:o,price:c})=>{const t=document.createElement("section");t.className="product",t.appendChild(a("span","product__id",e));const n=a("div","img__container");n.appendChild(m(o)),t.appendChild(n),t.appendChild(a("span","product__title",r));const s=a("span","product__price","R$ ");s.appendChild(a("span","product__price__value",c)),t.appendChild(s);const d=a("button","product__add","Adicionar ao carrinho!");t.appendChild(d);const i=document.querySelector(".cart__products");return d.addEventListener("click",async l=>{const p=l.target.closest(".product");I(e);const y=q(p),v=await C(y),w=g(v);i.appendChild(w),_()}),t};const u=document.createElement("div"),E=document.querySelector(".header"),T=document.querySelector(".products"),$=document.querySelector(".cart__products");document.querySelector(".cep-button").addEventListener("click",S);const x=()=>{const e=document.createElement("div");return e.innerText="carregando...",e.classList.add("loading"),E.appendChild(e),e},O=()=>(u.innerText="Algum erro ocorreu, recarregue a p\xE1gina e tente novamente",u.classList.add("error"),E.appendChild(u),u),f=x(),j=async()=>{try{(await L("computador")).forEach(r=>{const o=N(r);T.appendChild(o)}),f.remove()}catch{f.remove(),O()}},D=async()=>{const e=h().map(o=>C(o));(await Promise.all(e)).forEach(o=>{$.appendChild(g(o))}),_()};window.onload=()=>{j(),D()};
